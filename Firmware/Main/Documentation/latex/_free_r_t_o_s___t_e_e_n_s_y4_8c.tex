\hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c}{}\doxysection{Free\+RTOS/\+Free\+RTOS\+\_\+\+TEENSY4.c File Reference}
\label{_free_r_t_o_s___t_e_e_n_s_y4_8c}\index{FreeRTOS/FreeRTOS\_TEENSY4.c@{FreeRTOS/FreeRTOS\_TEENSY4.c}}


Free\+RTOS for Teensy 4.\+0.  


{\ttfamily \#include \char`\"{}Free\+RTOS\+\_\+\+TEENSY4.\+h\char`\"{}}\newline
{\ttfamily \#include $<$Arduino.\+h$>$}\newline
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a232ceee9e10a97b8ec8f14503861e699}{CAL\+\_\+\+FACTOR}}~(\mbox{\hyperlink{_free_r_t_o_s_config__default_8h_a43bafb28b29491ec7f871319b5a3b2f8}{F\+\_\+\+CPU}}/7000)
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a4d5e82901421218561290929a1b12548}{delay\+MS}} (uint32\+\_\+t millis)
\item 
static void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a5da8b1b72bfdb1d8a8f7b8581e4160c2}{error\+Blink}} (int n)
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_aa8cad1e2decb59c70b8247133b61157c}{assert\+Blink}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a73f6aa45470ada02a5d6f3a522d8f13c}{v\+Application\+Malloc\+Failed\+Hook}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a201468129b483039afc5a619e2d31097}{\+\_\+\+\_\+attribute\+\_\+\+\_\+}} ((weak))
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a306672a74bdd13ce210c05fca3385c59}{v\+Application\+Stack\+Overflow\+Hook}} (\mbox{\hyperlink{task_8h_a25b35e6e19ecf894173e7ff95edb96ef}{Task\+Handle\+\_\+t}} px\+Task, char $\ast$pc\+Task\+Name)
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a5b27d72b205084efd5c6b2f18838724b}{hard\+\_\+fault\+\_\+isr}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a2af56a8bf3197b2f06cac4c0b84ffc3e}{Hard\+Fault\+\_\+\+Handler}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_ae2d60774bb61a4f46e670ea245570f95}{bus\+\_\+fault\+\_\+isr}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a12baaa0dec32c007fbc333df880025c9}{Bus\+Fault\+\_\+\+Handler}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_af556591e06c5d6cad7fd16bdc3f2da1e}{usage\+\_\+fault\+\_\+isr}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_ac4b80575ac8f7fdb0c96faa95810d0e4}{Usage\+Fault\+\_\+\+Handler}} ()
\item 
void \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_ab042bd469054b754e2710fa560fd3ff7}{v\+Main\+Configure\+Timer\+For\+Run\+Time\+Stats}} (void)
\item 
unsigned long \mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a128013062564ee200ba30d0369b9865c}{ul\+Main\+Get\+Run\+Time\+Counter\+Value}} ()
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
Free\+RTOS for Teensy 4.\+0. 



\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a232ceee9e10a97b8ec8f14503861e699}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a232ceee9e10a97b8ec8f14503861e699}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!CAL\_FACTOR@{CAL\_FACTOR}}
\index{CAL\_FACTOR@{CAL\_FACTOR}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{CAL\_FACTOR}{CAL\_FACTOR}}
{\footnotesize\ttfamily \#define CAL\+\_\+\+FACTOR~(\mbox{\hyperlink{_free_r_t_o_s_config__default_8h_a43bafb28b29491ec7f871319b5a3b2f8}{F\+\_\+\+CPU}}/7000)}

calibration factor for delay\+MS 

\doxysubsection{Function Documentation}
\mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a201468129b483039afc5a619e2d31097}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a201468129b483039afc5a619e2d31097}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!\_\_attribute\_\_@{\_\_attribute\_\_}}
\index{\_\_attribute\_\_@{\_\_attribute\_\_}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{\_\_attribute\_\_()}{\_\_attribute\_\_()}}
{\footnotesize\ttfamily void \+\_\+\+\_\+attribute\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{(weak)}]{ }\end{DoxyParamCaption})}

v\+Application\+Idle\+Hook() will only be called if config\+USE\+\_\+\+IDLE\+\_\+\+HOOK is set to 1 in \mbox{\hyperlink{_free_r_t_o_s_config_8h}{Free\+RTOSConfig.\+h}}. It will be called on each iteration of the idle task. It is essential that code added to this hook function never attempts to block in any way (for example, call \mbox{\hyperlink{queue_8c_ad0a166f3b1219a5e37e31f8090d4800d}{x\+Queue\+Receive()}} with a block time specified, or call \mbox{\hyperlink{task_8h_aa154068cecd7f31446a7a84af44ab1a3}{v\+Task\+Delay()}}). If the application makes use of the \mbox{\hyperlink{task_8h_a27ff4ebce26565bef136bda84201ff80}{v\+Task\+Delete()}} API function (as this demo application does) then it is also important that v\+Application\+Idle\+Hook() is permitted to return to its calling function, because it is the responsibility of the idle task to clean up memory allocated by the kernel to any task that has since been deleted.

This function will be called by each tick interrupt if config\+USE\+\_\+\+TICK\+\_\+\+HOOK is set to 1 in \mbox{\hyperlink{_free_r_t_o_s_config_8h}{Free\+RTOSConfig.\+h}}. User code can be added here, but the tick hook is called from an interrupt context, so code must not attempt to block, and only the interrupt safe Free\+RTOS API functions can be used (those that end in From\+ISR()). \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_aa8cad1e2decb59c70b8247133b61157c}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_aa8cad1e2decb59c70b8247133b61157c}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!assertBlink@{assertBlink}}
\index{assertBlink@{assertBlink}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{assertBlink()}{assertBlink()}}
{\footnotesize\ttfamily void assert\+Blink (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

assert\+Blink Blink one short pulse every two seconds if config\+ASSERT fails. \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_ae2d60774bb61a4f46e670ea245570f95}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_ae2d60774bb61a4f46e670ea245570f95}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!bus\_fault\_isr@{bus\_fault\_isr}}
\index{bus\_fault\_isr@{bus\_fault\_isr}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{bus\_fault\_isr()}{bus\_fault\_isr()}}
{\footnotesize\ttfamily void bus\+\_\+fault\+\_\+isr (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Bus fault -\/ blink five short flashes every two seconds \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a12baaa0dec32c007fbc333df880025c9}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a12baaa0dec32c007fbc333df880025c9}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!BusFault\_Handler@{BusFault\_Handler}}
\index{BusFault\_Handler@{BusFault\_Handler}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{BusFault\_Handler()}{BusFault\_Handler()}}
{\footnotesize\ttfamily void Bus\+Fault\+\_\+\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Bus fault -\/ blink five short flashes every two seconds \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a4d5e82901421218561290929a1b12548}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a4d5e82901421218561290929a1b12548}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!delayMS@{delayMS}}
\index{delayMS@{delayMS}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{delayMS()}{delayMS()}}
{\footnotesize\ttfamily static void delay\+MS (\begin{DoxyParamCaption}\item[{uint32\+\_\+t}]{millis }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

delay between led error flashes 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em millis} & milliseconds to delay \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a5da8b1b72bfdb1d8a8f7b8581e4160c2}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a5da8b1b72bfdb1d8a8f7b8581e4160c2}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!errorBlink@{errorBlink}}
\index{errorBlink@{errorBlink}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{errorBlink()}{errorBlink()}}
{\footnotesize\ttfamily static void error\+Blink (\begin{DoxyParamCaption}\item[{int}]{n }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [static]}}

Blink error pattern


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em n} & number of short pulses \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a5b27d72b205084efd5c6b2f18838724b}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a5b27d72b205084efd5c6b2f18838724b}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!hard\_fault\_isr@{hard\_fault\_isr}}
\index{hard\_fault\_isr@{hard\_fault\_isr}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{hard\_fault\_isr()}{hard\_fault\_isr()}}
{\footnotesize\ttfamily void hard\+\_\+fault\+\_\+isr (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Hard fault -\/ blink four short flash every two seconds \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a2af56a8bf3197b2f06cac4c0b84ffc3e}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a2af56a8bf3197b2f06cac4c0b84ffc3e}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!HardFault\_Handler@{HardFault\_Handler}}
\index{HardFault\_Handler@{HardFault\_Handler}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{HardFault\_Handler()}{HardFault\_Handler()}}
{\footnotesize\ttfamily void Hard\+Fault\+\_\+\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Hard fault -\/ blink four short flash every two seconds \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a128013062564ee200ba30d0369b9865c}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a128013062564ee200ba30d0369b9865c}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!ulMainGetRunTimeCounterValue@{ulMainGetRunTimeCounterValue}}
\index{ulMainGetRunTimeCounterValue@{ulMainGetRunTimeCounterValue}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{ulMainGetRunTimeCounterValue()}{ulMainGetRunTimeCounterValue()}}
{\footnotesize\ttfamily unsigned long ul\+Main\+Get\+Run\+Time\+Counter\+Value (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Dummy function \begin{DoxyReturn}{Returns}
zero 
\end{DoxyReturn}
\mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_af556591e06c5d6cad7fd16bdc3f2da1e}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_af556591e06c5d6cad7fd16bdc3f2da1e}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!usage\_fault\_isr@{usage\_fault\_isr}}
\index{usage\_fault\_isr@{usage\_fault\_isr}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{usage\_fault\_isr()}{usage\_fault\_isr()}}
{\footnotesize\ttfamily void usage\+\_\+fault\+\_\+isr (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Usage fault -\/ blink six short flashes every two seconds \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_ac4b80575ac8f7fdb0c96faa95810d0e4}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_ac4b80575ac8f7fdb0c96faa95810d0e4}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!UsageFault\_Handler@{UsageFault\_Handler}}
\index{UsageFault\_Handler@{UsageFault\_Handler}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{UsageFault\_Handler()}{UsageFault\_Handler()}}
{\footnotesize\ttfamily void Usage\+Fault\+\_\+\+Handler (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

Usage fault -\/ blink six short flashes every two seconds \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a73f6aa45470ada02a5d6f3a522d8f13c}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a73f6aa45470ada02a5d6f3a522d8f13c}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!vApplicationMallocFailedHook@{vApplicationMallocFailedHook}}
\index{vApplicationMallocFailedHook@{vApplicationMallocFailedHook}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{vApplicationMallocFailedHook()}{vApplicationMallocFailedHook()}}
{\footnotesize\ttfamily void v\+Application\+Malloc\+Failed\+Hook (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\mbox{\hyperlink{_free_r_t_o_s___t_e_e_n_s_y4_8c_a73f6aa45470ada02a5d6f3a522d8f13c}{v\+Application\+Malloc\+Failed\+Hook()}} Blink two short pulses if malloc fails.

will only be called if config\+USE\+\_\+\+MALLOC\+\_\+\+FAILED\+\_\+\+HOOK is set to 1 in \mbox{\hyperlink{_free_r_t_o_s_config_8h}{Free\+RTOSConfig.\+h}}. It is a hook function that will get called if a call to \mbox{\hyperlink{heap__3_8c_ac56bcb7515f081a5b3df83935499fa4a}{pv\+Port\+Malloc()}} fails. \mbox{\hyperlink{heap__3_8c_ac56bcb7515f081a5b3df83935499fa4a}{pv\+Port\+Malloc()}} is called internally by the kernel whenever a task, queue, timer or semaphore is created. It is also called by various parts of the demo application. If heap\+\_\+1.\+c or heap\+\_\+2.\+c are used, then the size of the heap available to \mbox{\hyperlink{heap__3_8c_ac56bcb7515f081a5b3df83935499fa4a}{pv\+Port\+Malloc()}} is defined by config\+TOTAL\+\_\+\+HEAP\+\_\+\+SIZE in \mbox{\hyperlink{_free_r_t_o_s_config_8h}{Free\+RTOSConfig.\+h}}, and the \mbox{\hyperlink{portable_8h_a8f72fbee5c25c956bda528299ce6dd02}{x\+Port\+Get\+Free\+Heap\+Size()}} API function can be used to query the size of free heap space that remains (although it does not provide information on how the remaining heap might be fragmented). \mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_a306672a74bdd13ce210c05fca3385c59}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_a306672a74bdd13ce210c05fca3385c59}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!vApplicationStackOverflowHook@{vApplicationStackOverflowHook}}
\index{vApplicationStackOverflowHook@{vApplicationStackOverflowHook}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{vApplicationStackOverflowHook()}{vApplicationStackOverflowHook()}}
{\footnotesize\ttfamily void v\+Application\+Stack\+Overflow\+Hook (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{task_8h_a25b35e6e19ecf894173e7ff95edb96ef}{Task\+Handle\+\_\+t}}}]{px\+Task,  }\item[{char $\ast$}]{pc\+Task\+Name }\end{DoxyParamCaption})}

Blink three short pulses if stack overflow is detected. Run time stack overflow checking is performed if config\+CHECK\+\_\+\+FOR\+\_\+\+STACK\+\_\+\+OVERFLOW is defined to 1 or 2. This hook function is called if a stack overflow is detected. 
\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em px\+Task} & Task handle \\
\hline
\mbox{\texttt{ in}}  & {\em pc\+Task\+Name} & Task name \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{_free_r_t_o_s___t_e_e_n_s_y4_8c_ab042bd469054b754e2710fa560fd3ff7}\label{_free_r_t_o_s___t_e_e_n_s_y4_8c_ab042bd469054b754e2710fa560fd3ff7}} 
\index{FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}!vMainConfigureTimerForRunTimeStats@{vMainConfigureTimerForRunTimeStats}}
\index{vMainConfigureTimerForRunTimeStats@{vMainConfigureTimerForRunTimeStats}!FreeRTOS\_TEENSY4.c@{FreeRTOS\_TEENSY4.c}}
\doxysubsubsection{\texorpdfstring{vMainConfigureTimerForRunTimeStats()}{vMainConfigureTimerForRunTimeStats()}}
{\footnotesize\ttfamily void v\+Main\+Configure\+Timer\+For\+Run\+Time\+Stats (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}

Dummy time stats gathering functions need to be defined to keep the linker happy. Could edit \mbox{\hyperlink{_free_r_t_o_s_config_8h}{Free\+RTOSConfig.\+h}} to remove these. 